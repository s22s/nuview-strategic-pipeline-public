<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="NUVIEW Strategic Pipeline - Executive Dashboard for tracking global business development opportunities, funding programs, and strategic initiatives.">
    <meta name="keywords" content="NUVIEW, business development, opportunities, pipeline, funding, LiDAR, space systems">
    <meta name="author" content="NUVIEW Team">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="NUVIEW Branded Global Business Development - Executive Dashboard">
    <meta property="og:description" content="Strategic pipeline tracking and opportunity management for NUVIEW global initiatives.">
    <meta property="og:site_name" content="NUVIEW Strategic Pipeline">
    
    <!-- Performance Optimizations -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://api.github.com">
    
    <title>NUVIEW Branded Global Business Development - Executive Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- PapaParse for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <!-- Cytoscape.js for network diagram visualization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>
    
    <style>
        /* ============================================
           NUVIEW SPACEX-INSPIRED THEME - CSS VARIABLES
           ============================================
           
           PURPOSE:
           SpaceX-inspired deep space-black theme with minimal accent red.
           Red is used ONLY for highlights: active nav, badges, underlines, headers.
           Regular text uses clean off-greys and whites for readability.
           
           DESIGN PRINCIPLES:
           - Deep space-black backgrounds for dramatic effect
           - Clean, high-contrast text (white/off-grey)
           - Accent red (#E10600) sparingly: highlights, active states, badges
           - Modern card-style tables with soft stripes
           - Bold headers with subtle drop shadows
           - Score-badge pills for priority
           - Mobile-friendly responsive design
           
           LAST UPDATED: 2025-11-21
           ============================================ */
        :root { 
            /* Primary Brand Colors */
            --nuview-red: #E10600; 
            --nuview-red-dim: rgba(225, 6, 0, 0.1);
            
            /* Deep Space-Black Palette */
            --nuview-black: #000000;
            --nuview-space-dark: #0a0a0a;
            --nuview-space-medium: #1a1a1a;
            --nuview-space-light: #2a2a2a;
            
            /* Clean Off-Greys and Whites */
            --nuview-white: #ffffff;
            --nuview-off-white: #f0f0f0;
            --nuview-light-grey: #e0e0e0;
            --nuview-medium-grey: #b0b0b0;
            --nuview-dark-grey: #666666;
            
            /* Semantic Colors */
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --text-tertiary: #b0b0b0;
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --border-primary: #2a2a2a;
            --border-secondary: #1a1a1a;
            
            /* Responsive Spacing */
            --responsive-margin: 20px;
        }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(180deg, var(--nuview-black) 0%, var(--nuview-space-dark) 50%, var(--nuview-black) 100%); 
            color: var(--text-primary); 
            margin: 0; 
            padding: 0; 
        }
        .header { 
            background: linear-gradient(135deg, var(--nuview-black) 0%, var(--nuview-space-dark) 100%); 
            color: var(--nuview-white); 
            padding: 2.5rem 0; 
            text-align: center; 
            border-bottom: 3px solid var(--nuview-red); 
            box-shadow: 0 8px 32px rgba(0,0,0,0.6); 
            position: relative;
        }
        .header-logo {
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
            background: linear-gradient(90deg, var(--nuview-white) 0%, var(--nuview-red) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }
        .header-actions {
            margin-top: 1.5rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .header-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, var(--nuview-red) 0%, #c82630 100%);
            color: var(--nuview-white);
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 4px 16px rgba(225, 6, 0, 0.4);
        }
        .header-btn:hover {
            background: linear-gradient(135deg, #c82630 0%, var(--nuview-red) 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 24px rgba(225, 6, 0, 0.6);
            border-color: var(--nuview-white);
            color: var(--nuview-white);
        }
        .header-btn:active {
            transform: translateY(-1px);
        }
        .header-btn.secondary {
            background: linear-gradient(135deg, var(--nuview-space-medium) 0%, var(--nuview-space-light) 100%);
            box-shadow: 0 4px 16px rgba(255, 255, 255, 0.1);
        }
        .header-btn.secondary:hover {
            background: linear-gradient(135deg, var(--nuview-space-light) 0%, var(--nuview-space-medium) 100%);
            box-shadow: 0 6px 24px rgba(255, 255, 255, 0.2);
        }
        .sidebar { 
            position: fixed; 
            left: 0; 
            top: 0; 
            height: 100%; 
            width: 260px; 
            background: linear-gradient(180deg, var(--nuview-space-dark) 0%, var(--nuview-black) 100%); 
            box-shadow: 4px 0 24px rgba(0,0,0,0.8); 
            z-index: 100; 
            border-right: 2px solid var(--nuview-red); 
            padding-top: 2rem; 
            overflow-y: auto; 
        }
        .sidebar a { 
            color: var(--text-secondary); 
            text-decoration: none; 
            display: block; 
            padding: 0.75rem 1.25rem; 
            margin: 0.25rem 0.5rem; 
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        .sidebar a:hover { 
            background: linear-gradient(90deg, var(--nuview-red-dim) 0%, rgba(255, 255, 255, 0.05) 100%); 
            color: var(--nuview-white); 
            border-left: 3px solid var(--nuview-red); 
            padding-left: 1rem;
            transform: translateX(4px);
        }
        .sidebar a.active { 
            background: linear-gradient(90deg, var(--nuview-red) 0%, rgba(225, 6, 0, 0.2) 100%); 
            color: var(--nuview-white); 
            border-left: 3px solid var(--nuview-white); 
            font-weight: 600;
        }
        .main-content { 
            margin-left: 260px; 
            margin-right: 320px;
            padding: 30px; 
            min-height: 100vh; 
            background: var(--bg-primary);
        }
        .launched-opps-box {
            position: fixed;
            right: var(--responsive-margin);
            top: var(--responsive-margin);
            width: 280px;
            max-height: calc(100vh - 40px);
            background: linear-gradient(180deg, var(--nuview-space-dark) 0%, var(--nuview-black) 100%);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 12px 40px rgba(0,0,0,0.9);
            border: 2px solid var(--nuview-red);
            z-index: 90;
            overflow-y: auto;
            transition: all 0.3s ease;
        }
        .launched-opps-box:hover {
            box-shadow: 0 16px 48px rgba(225, 6, 0, 0.3);
            transform: translateY(-2px);
        }
        .launched-opps-box h3 {
            color: var(--nuview-white);
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--nuview-red);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .launched-opp-item {
            background: var(--nuview-space-medium);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 3px solid var(--nuview-red);
            box-shadow: 0 4px 16px rgba(0,0,0,0.6);
            transition: all 0.2s ease;
        }
        .launched-opp-item:hover {
            box-shadow: 0 6px 24px rgba(225, 6, 0, 0.3);
            transform: translateX(-3px);
            border-left-color: var(--nuview-white);
        }
        .launched-opp-item h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--nuview-white);
            margin-bottom: 0.5rem;
        }
        .launched-opp-item p {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin: 0.25rem 0;
        }
        .launched-opp-value {
            font-weight: 700;
            color: var(--nuview-red);
            font-size: 0.95rem;
        }
        .launched-opps-empty {
            text-align: center;
            color: var(--text-tertiary);
            font-style: italic;
            padding: 2rem 0;
        }
        .launched-opp-link {
            color: var(--nuview-red);
            font-weight: 600;
            text-decoration: underline;
        }
        .launched-opp-link:hover {
            color: var(--nuview-white);
        }
        .section { 
            background: linear-gradient(180deg, var(--nuview-space-dark) 0%, var(--nuview-space-medium) 100%); 
            border-radius: 16px; 
            padding: 2rem; 
            margin: 2rem 0; 
            box-shadow: 0 12px 40px rgba(0,0,0,0.8); 
            border: 1px solid var(--border-primary);
            transition: all 0.3s ease;
        }
        .section:hover {
            box-shadow: 0 16px 48px rgba(0,0,0,0.9), 0 0 0 1px var(--nuview-red);
            transform: translateY(-2px);
        }
        .section h2 { 
            color: var(--nuview-white); 
            border-bottom: 3px solid var(--nuview-red); 
            padding-bottom: 0.75rem; 
            margin-bottom: 1.5rem; 
            font-size: 1.75rem; 
            font-weight: 700;
        }
        @supports (background-clip: text) or (-webkit-background-clip: text) {
            .section h2 {
                background: linear-gradient(90deg, var(--nuview-white) 0%, var(--nuview-red) 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }
        }
        
        /* Modern Card-Style Tables with Soft Stripes */
        .matrix-table { 
            width: 100%; 
            border-collapse: separate; 
            border-spacing: 0; 
            margin-top: 1.5rem;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.8);
        }
        .matrix-table thead th { 
            background: linear-gradient(135deg, var(--nuview-black) 0%, var(--nuview-space-dark) 100%); 
            color: var(--nuview-white); 
            padding: 1.2rem 1rem; 
            text-align: left; 
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--nuview-red);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .matrix-table thead th:first-child { border-top-left-radius: 12px; }
        .matrix-table thead th:last-child { border-top-right-radius: 12px; }
        .matrix-table tbody tr { 
            transition: all 0.2s ease;
            background: var(--nuview-space-dark);
        }
        .matrix-table tbody tr:nth-child(odd) { 
            background: linear-gradient(90deg, var(--nuview-space-medium) 0%, var(--nuview-space-dark) 100%); 
        }
        .matrix-table tbody tr:hover { 
            background: linear-gradient(90deg, rgba(225, 6, 0, 0.15) 0%, var(--nuview-space-medium) 100%);
            transform: scale(1.01);
            box-shadow: 0 4px 16px rgba(225, 6, 0, 0.3);
            cursor: pointer;
        }
        .matrix-table tbody td { 
            padding: 1rem; 
            border-bottom: 1px solid var(--border-secondary);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        .matrix-table tbody td:first-child { font-weight: 600; color: var(--nuview-white); }
        /* Score Badge Pills - Red accent for priority */
        .matrix-rank { 
            width: 50px; 
            text-align: center; 
            font-weight: 700; 
            font-size: 1.1rem;
            color: var(--nuview-red);
            background: linear-gradient(135deg, rgba(225, 6, 0, 0.2) 0%, rgba(225, 6, 0, 0.1) 100%);
            border-radius: 8px;
        }
        .matrix-value { 
            font-weight: 700; 
            color: var(--nuview-red);
            font-size: 1.05rem;
        }
        .matrix-link { 
            text-align: center;
        }
        .matrix-link-btn { 
            display: inline-block;
            padding: 0.5rem 1rem; 
            background: linear-gradient(135deg, var(--nuview-red) 0%, #c82630 100%);
            color: var(--nuview-white); 
            text-decoration: none; 
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 4px 16px rgba(225, 6, 0, 0.4);
        }
        .matrix-link-btn:hover { 
            background: linear-gradient(135deg, #c82630 0%, var(--nuview-red) 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(225, 6, 0, 0.6);
            border-color: var(--nuview-white);
        }
        .matrix-link-btn:focus {
            outline: 3px solid rgba(225, 6, 0, 0.5);
            outline-offset: 2px;
        }
        .matrix-source-badge {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            background: linear-gradient(135deg, var(--nuview-space-light) 0%, var(--nuview-space-medium) 100%);
            color: var(--text-secondary);
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
            transition: all 0.2s ease;
            border: 1px solid var(--border-primary);
        }
        .matrix-source-badge:hover {
            background: linear-gradient(135deg, var(--nuview-space-medium) 0%, var(--nuview-space-light) 100%);
            transform: scale(1.05);
            border-color: var(--nuview-red);
        }
        
        .search-container { 
            padding: 1.25rem; 
            background: linear-gradient(135deg, var(--nuview-space-dark) 0%, var(--nuview-space-medium) 100%); 
            margin: 1.5rem 0; 
            border-radius: 12px; 
            box-shadow: 0 8px 32px rgba(0,0,0,0.8); 
            border: 1px solid var(--border-primary);
        }
        .search-input { 
            width: 100%; 
            padding: 0.875rem; 
            border: 2px solid var(--border-primary); 
            border-radius: 10px; 
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--nuview-black);
            color: var(--text-primary);
        }
        .search-input:focus {
            outline: none;
            border-color: var(--nuview-red);
            box-shadow: 0 0 0 3px rgba(225, 6, 0, 0.2);
        }
        .program-card { 
            background: linear-gradient(135deg, var(--nuview-space-dark) 0%, var(--nuview-space-medium) 100%); 
            border-radius: 12px; 
            padding: 1.5rem; 
            margin-bottom: 1.25rem; 
            border-left: 4px solid var(--nuview-red); 
            box-shadow: 0 8px 32px rgba(0,0,0,0.8); 
            transition: all 0.3s ease;
            border: 1px solid var(--border-primary);
        }
        .program-card:hover { 
            box-shadow: 0 12px 40px rgba(225, 6, 0, 0.3); 
            transform: translateY(-4px); 
            border-left-color: var(--nuview-white);
            background: linear-gradient(135deg, var(--nuview-space-medium) 0%, rgba(225, 6, 0, 0.1) 100%);
        }
        .program-card.hidden { display: none; }
        .urgency-badge { display: inline-block; padding: 0.3rem 0.85rem; border-radius: 12px; font-size: 0.8rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
        .urgency-urgent { background: var(--nuview-red); color: var(--nuview-white); box-shadow: 0 4px 12px rgba(225, 6, 0, 0.4); }
        .urgency-near { background: #ff9500; color: var(--nuview-black); }
        .urgency-future { background: #30d158; color: var(--nuview-black); }
        
        /* Executive Metrics Cards Animation */
        .card {
            transition: all 0.3s ease;
            background: linear-gradient(135deg, var(--nuview-space-dark) 0%, var(--nuview-space-medium) 100%);
            border: 2px solid var(--border-primary);
            box-shadow: 0 8px 32px rgba(0,0,0,0.8);
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 16px 48px rgba(225, 6, 0, 0.3);
            border-color: var(--nuview-red) !important;
        }
        .card i {
            animation: pulse 2s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.9; }
        }
        
        /* Pipeline Diagram Styles */
        .pipeline-diagram-container { width: 100%; overflow-x: auto; padding: 1rem 0; }
        .pipeline-svg { width: 100%; height: auto; min-width: 800px; }
        .pipeline-stage { cursor: pointer; transition: all 0.3s ease; }
        .pipeline-stage:hover rect { filter: url(#stageShadow) brightness(1.2); }
        .pipeline-stage:hover text { fill: var(--nuview-red); }
        .pipeline-arrow { animation: flowAnimation 2s ease-in-out infinite; }
        @keyframes flowAnimation {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Tooltip Styles */
        .pipeline-tooltip { position: absolute; background: var(--nuview-space-dark); color: var(--nuview-white); padding: 0.75rem 1rem; border-radius: 8px; font-size: 0.9rem; pointer-events: none; opacity: 0; transition: opacity 0.3s ease; z-index: 1000; box-shadow: 0 8px 32px rgba(0,0,0,0.9); max-width: 280px; border: 2px solid var(--nuview-red); }
        .pipeline-tooltip::after { content: ''; position: absolute; top: 100%; left: 50%; margin-left: -6px; border: 6px solid transparent; border-top-color: var(--nuview-red); }
        .pipeline-tooltip.show { opacity: 1; }
        
        /* Table wrapper for horizontal scroll on mobile */
        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 1rem 0;
        }
        
        /* Respect user motion preferences */
        @media (prefers-reduced-motion: reduce) {
            .sidebar,
            .program-card,
            .matrix-table tbody tr,
            .section,
            .pipeline-stage,
            .matrix-link-btn {
                animation: none;
                transition: none;
            }
        }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .main-content {
                margin-right: 20px;
            }
            .launched-opps-box {
                width: 260px;
            }
        }
        @media (max-width: 992px) {
            .main-content {
                margin-left: 260px;
                margin-right: var(--responsive-margin);
            }
            .launched-opps-box {
                position: relative;
                right: auto;
                top: auto;
                width: 100%;
                max-height: none;
                margin-bottom: 2rem;
            }
            .header-actions {
                flex-direction: column;
                align-items: center;
            }
            .header-btn {
                width: 90%;
                justify-content: center;
            }
        }
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            .main-content {
                margin-left: 200px;
            }
            .pipeline-svg { 
                min-width: 600px; 
            }
            .pipeline-legend { 
                font-size: 0.85rem; 
            }
            .matrix-table {
                font-size: 0.85rem;
            }
            .matrix-table thead th,
            .matrix-table tbody td {
                padding: 0.75rem 0.5rem;
            }
        }
        @media (max-width: 576px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                border-right: none;
                border-bottom: 3px solid var(--nuview-red);
            }
            .main-content {
                margin-left: 0;
                padding: 15px;
            }
            .header {
                padding: 1.5rem 1rem;
            }
            .header-logo {
                font-size: 1.8rem;
            }
            .section {
                padding: 1.25rem;
                margin: 1rem 0;
            }
            .section h2 {
                font-size: 1.4rem;
            }
            .header-btn {
                width: 100%;
                font-size: 0.9rem;
                padding: 0.65rem 1.25rem;
            }
        }
        
        /* Floating Rocket Button Styles */
        .floating-rocket-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--nuview-red) 0%, #c82630 100%);
            border: 4px solid var(--nuview-white);
            box-shadow: 0 12px 40px rgba(225, 6, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 9999;
            animation: float 3s ease-in-out infinite;
        }
        
        .floating-rocket-btn:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 16px 48px rgba(225, 6, 0, 0.8);
            background: linear-gradient(135deg, #c82630 0%, var(--nuview-red) 100%);
        }
        
        .floating-rocket-btn:active {
            transform: translateY(-2px) scale(1.05);
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        .floating-rocket-btn.launching {
            animation: launch 1s ease-out forwards;
        }
        
        @keyframes launch {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            50% {
                transform: translateY(-30px) scale(1.2);
                opacity: 0.8;
            }
            100% {
                transform: translateY(-100vh) scale(0.5);
                opacity: 0;
            }
        }
        
        .rocket-tooltip {
            position: fixed;
            bottom: 110px;
            right: 30px;
            background: var(--nuview-space-dark);
            color: var(--nuview-white);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 8px 32px rgba(0,0,0,0.9);
            z-index: 9998;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            white-space: nowrap;
            border: 2px solid var(--nuview-red);
        }
        
        .rocket-tooltip.show {
            opacity: 1;
        }
        
        .rocket-tooltip::after {
            content: '';
            position: absolute;
            bottom: -12px;
            right: 28px;
            border: 6px solid transparent;
            border-top-color: var(--nuview-red);
        }
        
        /* Authentication Modal Styles */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }
        
        .auth-modal.show {
            display: flex;
        }
        
        .auth-modal-content {
            background: linear-gradient(180deg, var(--nuview-space-dark) 0%, var(--nuview-space-medium) 100%);
            border-radius: 16px;
            padding: 2.5rem;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 24px 80px rgba(0,0,0,0.9);
            border: 3px solid var(--nuview-red);
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .auth-modal-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        .auth-modal-header h2 {
            color: var(--nuview-white);
            margin: 0.5rem 0;
            font-size: 1.75rem;
        }
        
        .auth-modal-header .rocket-icon {
            font-size: 48px;
        }
        
        .auth-modal-body {
            margin-bottom: 1.5rem;
        }
        
        .auth-modal-body p {
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
        }
        
        .auth-input-group {
            margin-bottom: 1rem;
        }
        
        .auth-input-group label {
            display: block;
            color: var(--nuview-white);
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        .auth-input-group input {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--border-primary);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--nuview-black);
            color: var(--text-primary);
        }
        
        .auth-input-group input:focus {
            outline: none;
            border-color: var(--nuview-red);
            box-shadow: 0 0 0 3px rgba(225, 6, 0, 0.2);
        }
        
        .auth-modal-footer {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        
        .auth-btn {
            padding: 0.875rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .auth-btn-primary {
            background: linear-gradient(135deg, var(--nuview-red) 0%, #c82630 100%);
            color: var(--nuview-white);
        }
        
        .auth-btn-primary:hover {
            background: linear-gradient(135deg, #c82630 0%, var(--nuview-red) 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(225, 6, 0, 0.6);
        }
        
        .auth-btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .auth-btn-secondary {
            background: var(--nuview-space-light);
            color: var(--nuview-white);
        }
        
        .auth-btn-secondary:hover {
            background: var(--nuview-space-medium);
            transform: translateY(-2px);
        }
        
        .auth-error {
            background: rgba(225, 6, 0, 0.2);
            border: 2px solid var(--nuview-red);
            color: var(--nuview-red);
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            display: none;
        }
        
        .auth-error.show {
            display: block;
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .auth-success {
            background: rgba(48, 209, 88, 0.2);
            border: 2px solid #30d158;
            color: #30d158;
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            display: none;
        }
        
        .auth-success.show {
            display: block;
        }
        
        .trigger-instructions {
            background: linear-gradient(135deg, var(--nuview-space-medium) 0%, var(--nuview-space-light) 100%);
            border: 2px solid var(--border-primary);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            display: none;
            text-align: left;
        }
        
        .trigger-instructions.show {
            display: block;
        }
        
        .trigger-instructions h4 {
            color: var(--nuview-white);
            margin: 0 0 0.75rem 0;
            font-size: 1rem;
        }
        
        .trigger-instructions ol {
            margin: 0;
            padding-left: 1.5rem;
            color: var(--text-secondary);
        }
        
        .trigger-instructions li {
            margin: 0.5rem 0;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .trigger-instructions code {
            background: var(--nuview-black);
            color: var(--nuview-white);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
            display: inline-block;
            margin: 0.25rem 0;
        }
        
        .trigger-instructions a {
            color: var(--nuview-red);
            font-weight: 600;
            text-decoration: none;
        }
        
        .trigger-instructions a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

<nav class="sidebar">
    <h3 style="padding-left:1rem; color:var(--nuview-navy); font-weight:800;">BUSINESS DEVELOPMENT</h3>
    <a href="#overview" class="active"><i class="bi bi-briefcase"></i> Executive Overview</a>
    <a href="executive-summary.html"><i class="bi bi-file-earmark-text"></i> Executive Summary</a>
    <a href="strategic-pipeline.html"><i class="bi bi-speedometer2"></i> Strategic Pipeline</a>
    <a href="scripts-documentation.html"><i class="bi bi-code-slash"></i> Scripts Documentation</a>
    <a href="#top-opportunities"><i class="bi bi-trophy"></i> Top Opportunities</a>
    <a href="#funding"><i class="bi bi-currency-dollar"></i> Funding Programs</a>
    <a href="#lidar"><i class="bi bi-radar"></i> LiDAR Initiatives</a>
    <a href="#space-systems"><i class="bi bi-rocket-takeoff"></i> Space Systems</a>
    <a href="#platform"><i class="bi bi-server"></i> Platform Solutions</a>
    <a href="pipeline.html"><i class="bi bi-funnel"></i> Pipeline Tracker</a>
    <a href="pipeline_matrix.html"><i class="bi bi-diagram-3"></i> Strategic Matrix</a>
    <a href="global-tracker.html"><i class="bi bi-globe"></i> Global Tracker</a>
</nav>

<main class="main-content" role="main">
    <header class="header" role="banner">
        <div class="header-content">
            <div class="header-logo" aria-label="NUVIEW logo">NUVIEW</div>
            <h1>NUVIEW Branded Global Business Development</h1>
            <p class="header-subtitle">Strategic Intelligence ‚Ä¢ Revenue Growth ‚Ä¢ High-Priority Opportunities</p>
        </div>
    </header>

    <!-- Launched Opportunities Fixed Box -->
    <aside class="launched-opps-box" role="complementary" aria-label="Launched Opportunities">
        <h3>
            <i class="bi bi-rocket-takeoff-fill"></i>
            Launched Opps
        </h3>
        <div id="launched-opps-container">
            <div class="launched-opps-empty">
                Loading launched opportunities...
            </div>
        </div>
    </aside>

    <!-- Section 2: How It Works -->
    <!-- 
        LIDAR-ENABLED SERVICES & MAPPING METADATA:
        This section visualizes the core pipeline for LIDAR data processing and opportunity tracking.
        The board integrates mapping metadata that is both visually accessible through the interface
        and layered on interactive parsing forms for enhanced workflow management.
        
        ASSUMPTIONS ABOUT BUDGET DATA:
        - All budget numbers presented have sufficient archived-history framework
        - Data is structured for rapid dissemination across organizations and software circle apps
        - Historical tracking enables trend analysis and forecasting for strategic planning
        
        FUTURE WORKFLOW INTEGRATION CONCEPTS:
        - Dashboard designed to connect with live SharePoint via Office365 for sales deck collaboration
        - Supports connected edit-primary feeds for real-time data synchronization
        - Architected to integrate with Zoomed Global Version-Agents and Super Integrative CRM models
        - Enables automated workflows for opportunity management and team coordination
    -->
    <div class="section" style="margin-top: 2rem;">
        <h2><i class="bi bi-diagram-3"></i> How It Works</h2>
        <p style="color: #666; margin-bottom: 2rem;">Our intelligent pipeline processes global opportunities through multiple stages to deliver actionable intelligence.</p>
        
        <div class="pipeline-diagram-container">
            <svg viewBox="0 0 1200 300" xmlns="http://www.w3.org/2000/svg" class="pipeline-svg">
                <!-- Definitions for gradients and filters -->
                <defs>
                    <linearGradient id="stageGradient1" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#f8f9fa;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#e9ecef;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="stageGradient2" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#f1f3f5;stop-opacity:1" />
                    </linearGradient>
                    <filter id="stageShadow">
                        <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.15"/>
                    </filter>
                    <linearGradient id="redAccent" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#E10600;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#d62d32;stop-opacity:1" />
                    </linearGradient>
                </defs>
                
                <!-- Stage 1: Data Sources -->
                <g class="pipeline-stage" data-stage="sources">
                    <rect x="30" y="80" width="220" height="140" rx="12" fill="url(#stageGradient1)" stroke="#001F3F" stroke-width="3" filter="url(#stageShadow)"/>
                    <rect x="30" y="80" width="220" height="8" rx="12" fill="url(#redAccent)"/>
                    <text x="140" y="115" text-anchor="middle" font-size="18" font-weight="700" fill="#001F3F">Data Sources</text>
                    <text x="140" y="145" text-anchor="middle" font-size="12" fill="#495057">Federal Contracts</text>
                    <text x="140" y="165" text-anchor="middle" font-size="12" fill="#495057">Research Programs</text>
                    <text x="140" y="185" text-anchor="middle" font-size="12" fill="#495057">Market Intelligence</text>
                    <text x="140" y="205" text-anchor="middle" font-size="12" fill="#495057">Industry Reports</text>
                    <circle cx="140" cy="55" r="20" fill="#E10600" opacity="0.1"/>
                    <text x="140" y="62" text-anchor="middle" font-size="20" fill="#E10600">üìä</text>
                </g>
                
                <!-- Arrow 1 -->
                <g class="pipeline-arrow">
                    <line x1="250" y1="150" x2="290" y2="150" stroke="#007BFF" stroke-width="4"/>
                    <polygon points="290,150 280,145 280,155" fill="#007BFF"/>
                </g>
                
                <!-- Stage 2: Engine -->
                <g class="pipeline-stage" data-stage="engine">
                    <rect x="310" y="80" width="220" height="140" rx="12" fill="url(#stageGradient2)" stroke="#001F3F" stroke-width="3" filter="url(#stageShadow)"/>
                    <rect x="310" y="80" width="220" height="8" rx="12" fill="url(#redAccent)"/>
                    <text x="420" y="115" text-anchor="middle" font-size="18" font-weight="700" fill="#001F3F">Processing Engine</text>
                    <text x="420" y="145" text-anchor="middle" font-size="12" fill="#495057">Data Aggregation</text>
                    <text x="420" y="165" text-anchor="middle" font-size="12" fill="#495057">Normalization</text>
                    <text x="420" y="185" text-anchor="middle" font-size="12" fill="#495057">Entity Matching</text>
                    <text x="420" y="205" text-anchor="middle" font-size="12" fill="#495057">Deduplication</text>
                    <circle cx="420" cy="55" r="20" fill="#007BFF" opacity="0.1"/>
                    <text x="420" y="62" text-anchor="middle" font-size="20" fill="#007BFF">‚öôÔ∏è</text>
                </g>
                
                <!-- Arrow 2 -->
                <g class="pipeline-arrow">
                    <line x1="530" y1="150" x2="570" y2="150" stroke="#007BFF" stroke-width="4"/>
                    <polygon points="570,150 560,145 560,155" fill="#007BFF"/>
                </g>
                
                <!-- Stage 3: Scoring -->
                <g class="pipeline-stage" data-stage="scoring">
                    <rect x="590" y="80" width="220" height="140" rx="12" fill="url(#stageGradient1)" stroke="#001F3F" stroke-width="3" filter="url(#stageShadow)"/>
                    <rect x="590" y="80" width="220" height="8" rx="12" fill="url(#redAccent)"/>
                    <text x="700" y="115" text-anchor="middle" font-size="18" font-weight="700" fill="#001F3F">Scoring System</text>
                    <text x="700" y="145" text-anchor="middle" font-size="12" fill="#495057">Value Assessment</text>
                    <text x="700" y="165" text-anchor="middle" font-size="12" fill="#495057">Urgency Analysis</text>
                    <text x="700" y="185" text-anchor="middle" font-size="12" fill="#495057">Strategic Fit</text>
                    <text x="700" y="205" text-anchor="middle" font-size="12" fill="#495057">Risk Evaluation</text>
                    <circle cx="700" cy="55" r="20" fill="#E10600" opacity="0.1"/>
                    <text x="700" y="62" text-anchor="middle" font-size="20" fill="#E10600">üéØ</text>
                </g>
                
                <!-- Arrow 3 -->
                <g class="pipeline-arrow">
                    <line x1="810" y1="150" x2="850" y2="150" stroke="#007BFF" stroke-width="4"/>
                    <polygon points="850,150 840,145 840,155" fill="#007BFF"/>
                </g>
                
                <!-- Stage 4: Matrix -->
                <g class="pipeline-stage" data-stage="matrix">
                    <rect x="870" y="80" width="220" height="140" rx="12" fill="url(#stageGradient2)" stroke="#001F3F" stroke-width="3" filter="url(#stageShadow)"/>
                    <rect x="870" y="80" width="220" height="8" rx="12" fill="url(#redAccent)"/>
                    <text x="980" y="115" text-anchor="middle" font-size="18" font-weight="700" fill="#001F3F">Priority Matrix</text>
                    <text x="980" y="145" text-anchor="middle" font-size="12" fill="#495057">Action Priorities</text>
                    <text x="980" y="165" text-anchor="middle" font-size="12" fill="#495057">Dashboard Updates</text>
                    <text x="980" y="185" text-anchor="middle" font-size="12" fill="#495057">Alert Generation</text>
                    <text x="980" y="205" text-anchor="middle" font-size="12" fill="#495057">Report Distribution</text>
                    <circle cx="980" cy="55" r="20" fill="#007BFF" opacity="0.1"/>
                    <text x="980" y="62" text-anchor="middle" font-size="20" fill="#007BFF">üìã</text>
                </g>
                
                <!-- Data flow indicator -->
                <text x="600" y="270" text-anchor="middle" font-size="14" font-weight="600" fill="#6c757d" opacity="0.7">
                    <tspan x="600">‚Üê Continuous Data Flow ‚Üí</tspan>
                </text>
            </svg>
        </div>
        
        <div class="pipeline-legend" style="margin-top: 2rem; padding: 1rem; background: #f8f9fa; border-radius: 8px; border-left: 4px solid var(--nuview-blue);">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                <div>
                    <strong style="color: var(--nuview-navy);">üîÑ Real-time Updates:</strong>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; color: #666;">Automated daily data collection from multiple sources</p>
                </div>
                <div>
                    <strong style="color: var(--nuview-navy);">ü§ñ Smart Processing:</strong>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; color: #666;">AI-powered analysis and categorization</p>
                </div>
                <div>
                    <strong style="color: var(--nuview-navy);">üéØ Prioritization:</strong>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; color: #666;">Strategic scoring based on value, urgency, and fit</p>
                </div>
                <div>
                    <strong style="color: var(--nuview-navy);">üìä Actionable Insights:</strong>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; color: #666;">Clear next steps and deadline tracking</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Global Search -->
    <div class="search-container">
        <input 
            type="text" 
            id="globalSearch" 
            class="search-input" 
            placeholder="üîç Search programs by title, agency, category, or action..."
        >
    </div>

    <div id="overview" class="section">
        <h2><i class="bi bi-briefcase"></i> Executive Overview</h2>
        <div style="background: linear-gradient(135deg, rgba(0, 31, 63, 0.05) 0%, rgba(0, 123, 255, 0.05) 100%); padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; border-left: 4px solid var(--nuview-red);">
            <h3 style="color: var(--nuview-navy); margin-bottom: 1rem; font-size: 1.3rem;">Pipeline Health Summary</h3>
            <p style="color: var(--nuview-dark-gray); line-height: 1.6; margin-bottom: 0.5rem;">
                The global LiDAR market is projected to reach <strong style="color: var(--nuview-red);">$14.13B</strong> by 2034 
                with a CAGR of <strong style="color: var(--nuview-red);">19.43%</strong>. NUVIEW's space-based DaaS platform positions us 
                to capture significant market share through strategic partnerships and innovative solutions.
            </p>
            <p style="color: var(--nuview-dark-gray); line-height: 1.6; margin: 0;">
                <strong style="color: var(--nuview-navy);">Strategic Focus:</strong> High-value federal contracts, LiDAR infrastructure programs, 
                and space systems initiatives aligned with our core capabilities.
            </p>
        </div>
        
        <h3 style="color: var(--nuview-navy); margin-bottom: 1rem; font-size: 1.2rem;">Key Metrics</h3>
        <div class="row">
            <div class="col-md-3">
                <div class="card text-center" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border: 2px solid var(--nuview-light-gray); transition: all 0.3s ease;">
                    <i class="bi bi-kanban" style="font-size: 2rem; color: var(--nuview-blue); margin-bottom: 0.5rem;"></i>
                    <h3 id="total-programs" style="color: var(--nuview-navy); font-weight: 700;">0</h3>
                    <p class="text-muted" style="font-weight: 600;">Active Opportunities</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border: 2px solid var(--nuview-light-gray); transition: all 0.3s ease;">
                    <i class="bi bi-currency-dollar" style="font-size: 2rem; color: var(--nuview-red); margin-bottom: 0.5rem;"></i>
                    <h3 id="total-value" style="color: var(--nuview-red); font-weight: 700;">$0</h3>
                    <p class="text-muted" style="font-weight: 600;">Total Pipeline Value</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border: 2px solid var(--nuview-light-gray); transition: all 0.3s ease;">
                    <i class="bi bi-exclamation-triangle" style="font-size: 2rem; color: #E10600; margin-bottom: 0.5rem;"></i>
                    <h3 id="urgent-programs" style="color: #E10600; font-weight: 700;">0</h3>
                    <p class="text-muted" style="font-weight: 600;">Urgent Actions Required</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border: 2px solid var(--nuview-light-gray); transition: all 0.3s ease;">
                    <i class="bi bi-clock-history" style="font-size: 2rem; color: var(--nuview-gray); margin-bottom: 0.5rem;"></i>
                    <h3 id="last-updated" style="color: var(--nuview-navy); font-weight: 700;">Loading...</h3>
                    <p class="text-muted" style="font-weight: 600;">Last Updated</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Interactive Network Diagram with Cytoscape -->
    <div class="section" style="margin-top: 2rem;">
        <h2><i class="bi bi-diagram-3"></i> Opportunity Network Visualization</h2>
        <p style="color: var(--nuview-dark-gray); margin-bottom: 1.5rem;">
            Interactive network diagram showing relationships between agencies, categories, and opportunities. 
            <strong>Zoom, pan, and click</strong> nodes to explore connections.
        </p>
        <div style="background: white; border: 2px solid var(--nuview-light-gray); border-radius: 8px; padding: 1rem;">
            <div id="cy" style="width: 100%; height: 500px; background: #fafafa;"></div>
            <div style="margin-top: 1rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px;">
                <small style="color: var(--nuview-gray);">
                    <i class="bi bi-info-circle"></i> 
                    <strong>Controls:</strong> Mouse wheel to zoom, click and drag to pan, click nodes for details
                </small>
            </div>
        </div>
    </div>

    <!-- Priority Scoring Matrix -->
    <div id="priority-matrix" class="section">
        <h2><i class="bi bi-list-ol"></i> Priority Scoring Matrix</h2>
        <p style="color: var(--nuview-dark-gray); margin-bottom: 1.5rem;">
            All opportunities ranked by priority score (max 85 points). 
            Scoring factors: <strong>Urgency (30)</strong>, <strong>Value Tier (30)</strong>, <strong>Category (15)</strong>, <strong>Source Verification (10)</strong>.
            <button id="toggle-scoring-details" style="background: var(--nuview-red); color: white; border: none; padding: 0.25rem 0.75rem; border-radius: 4px; margin-left: 1rem; cursor: pointer;">
                Show Scoring Details
            </button>
        </p>
        
        <!-- Collapsible Scoring Details -->
        <div id="scoring-details" style="display: none; background: var(--nuview-space-light); padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid var(--nuview-red);">
            <h3 style="color: var(--nuview-red); margin-top: 0;">Priority Scoring Methodology</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; margin-top: 1rem;">
                <div style="background: var(--nuview-space-dark); padding: 1rem; border-radius: 6px;">
                    <h4 style="color: var(--nuview-red); margin-top: 0;"><i class="bi bi-clock-history"></i> Urgency Score (30 max)</h4>
                    <ul style="list-style: none; padding-left: 0; color: var(--text-secondary);">
                        <li>üî¥ <strong>Urgent</strong> (&lt;30 days): 30 points</li>
                        <li>üü° <strong>Near</strong> (30-89 days): 20 points</li>
                        <li>üü¢ <strong>Future</strong> (90+ days): 10 points</li>
                    </ul>
                </div>
                
                <div style="background: var(--nuview-space-dark); padding: 1rem; border-radius: 6px;">
                    <h4 style="color: var(--nuview-red); margin-top: 0;"><i class="bi bi-cash-stack"></i> Value Tier Score (30 max)</h4>
                    <ul style="list-style: none; padding-left: 0; color: var(--text-secondary);">
                        <li>üí∞ <strong>&gt;$100M</strong>: 30 points</li>
                        <li>üíµ <strong>$10M-$100M</strong>: 20 points</li>
                        <li>üí¥ <strong>&lt;$10M</strong>: 10 points</li>
                    </ul>
                </div>
                
                <div style="background: var(--nuview-space-dark); padding: 1rem; border-radius: 6px;">
                    <h4 style="color: var(--nuview-red); margin-top: 0;"><i class="bi bi-tag"></i> Category Score (15 max)</h4>
                    <ul style="list-style: none; padding-left: 0; color: var(--text-secondary);">
                        <li>üìä <strong>DaaS</strong>: 15 points</li>
                        <li>üñ•Ô∏è <strong>Platform</strong>: 10 points</li>
                        <li>üî¨ <strong>R&D</strong>: 5 points</li>
                    </ul>
                </div>
                
                <div style="background: var(--nuview-space-dark); padding: 1rem; border-radius: 6px;">
                    <h4 style="color: var(--nuview-red); margin-top: 0;"><i class="bi bi-check-circle"></i> Source Verification (10 max)</h4>
                    <ul style="list-style: none; padding-left: 0; color: var(--text-secondary);">
                        <li>‚úÖ <strong>Verified sources</strong>: 10 points</li>
                        <li>‚ùå <strong>Missing sources</strong>: 0 points</li>
                    </ul>
                </div>
            </div>
            
            <p style="margin-top: 1rem; padding: 1rem; background: rgba(225, 6, 0, 0.1); border-radius: 6px; color: var(--text-secondary);">
                <i class="bi bi-info-circle"></i> <strong>Total Possible Score:</strong> 85 points. 
                Higher scores indicate opportunities that are urgent, high-value, strategically aligned, and properly sourced.
            </p>
        </div>
        
        <div style="overflow-x: auto;">
            <table class="matrix-table" role="table" aria-label="Priority scoring matrix">
                <thead>
                    <tr>
                        <th class="matrix-rank" scope="col">Rank</th>
                        <th scope="col">Opportunity</th>
                        <th scope="col">Agency</th>
                        <th scope="col">Pillar</th>
                        <th scope="col">Category</th>
                        <th scope="col">Value</th>
                        <th scope="col">Priority Score</th>
                        <th scope="col">Urgency</th>
                        <th scope="col">Days Until</th>
                        <th scope="col">Deadline</th>
                    </tr>
                </thead>
                <tbody id="priority-matrix-body">
                    <tr>
                        <td colspan="10" style="text-align: center; padding: 2rem; color: var(--nuview-gray);">
                            Loading priority matrix...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Top 10 Opportunity Matrix -->
    <div id="top-opportunities" class="section">
        <h2><i class="bi bi-trophy"></i> Strategic Priority Opportunities</h2>
        <p style="color: var(--nuview-dark-gray); margin-bottom: 1.5rem;">
            <strong style="color: var(--nuview-navy);">Top 10 High-Value Opportunities</strong> ranked by strategic importance, revenue potential, and execution urgency. 
            These represent the highest-impact business development targets for immediate action and resource allocation.
        </p>
        <div style="overflow-x: auto;">
            <table class="matrix-table" role="table" aria-label="Top 10 opportunities matrix">
                <thead>
                    <tr>
                        <th class="matrix-rank" scope="col">#</th>
                        <th scope="col">Opportunity</th>
                        <th scope="col">Agency <span class="matrix-source-badge" role="note" aria-label="Clickable agency links">Link</span></th>
                        <th scope="col">Category</th>
                        <th scope="col">Value</th>
                        <th scope="col">Deadline</th>
                        <th scope="col">Urgency</th>
                        <th scope="col">Next Action</th>
                        <th class="matrix-link" scope="col">Opp Link</th>
                        <th class="matrix-link" scope="col">Budget Source</th>
                    </tr>
                </thead>
                <tbody id="top-opportunities-body">
                    <tr>
                        <!-- Colspan must match total number of columns in table header (10 columns) -->
                        <td colspan="10" style="text-align: center; padding: 2rem; color: var(--nuview-gray);">
                            Loading top opportunities...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="funding" class="section">
        <h2><i class="bi bi-currency-dollar"></i> Funding Programs & Revenue Opportunities</h2>
        <p style="color: var(--nuview-dark-gray); margin-bottom: 1.5rem;">Federal and commercial funding opportunities aligned with NUVIEW's strategic objectives and revenue growth targets.</p>
        <div id="funding-programs">
            <p>Loading funding programs...</p>
        </div>
    </div>

    <div id="lidar" class="section">
        <h2><i class="bi bi-radar"></i> LiDAR Technology Initiatives</h2>
        <p style="color: var(--nuview-dark-gray); margin-bottom: 1.5rem;">High-value LiDAR programs and infrastructure projects representing core business development opportunities.</p>
        <div id="lidar-programs">
            <p>Loading LiDAR programs...</p>
        </div>
    </div>

    <div id="space-systems" class="section">
        <h2><i class="bi bi-rocket-takeoff"></i> Space Systems & Satellite Programs</h2>
        <p style="color: var(--nuview-dark-gray); margin-bottom: 1.5rem;">Strategic space-based opportunities leveraging NUVIEW's satellite capabilities and data-as-a-service platform.</p>
        <div id="space-systems-programs">
            <p>Loading space systems programs...</p>
        </div>
    </div>

    <div id="platform" class="section">
        <h2><i class="bi bi-server"></i> Platform Solutions & Partnerships</h2>
        <p style="color: var(--nuview-dark-gray); margin-bottom: 1.5rem;">Technology platform initiatives and strategic partnerships driving long-term business value and market expansion.</p>
        <div id="platform-programs">
            <p>Loading platform programs...</p>
        </div>
    </div>
</main>

<script>
// Global data
let programsData = null;

// Format currency
function formatCurrency(amount) {
    if (!amount) return '$0';
    if (amount >= 1000000000) {
        return '$' + (amount / 1000000000).toFixed(2) + 'B';
    } else if (amount >= 1000000) {
        return '$' + (amount / 1000000).toFixed(1) + 'M';
    } else if (amount >= 1000) {
        return '$' + (amount / 1000).toFixed(0) + 'K';
    }
    return '$' + amount.toFixed(0);
}

// Get urgency badge
function getUrgencyBadge(urgency) {
    const badges = {
        'urgent': '<span class="urgency-badge urgency-urgent" role="status" aria-label="Urgent priority">URGENT</span>',
        'near': '<span class="urgency-badge urgency-near" role="status" aria-label="Near-term priority">NEAR</span>',
        'future': '<span class="urgency-badge urgency-future" role="status" aria-label="Future priority">FUTURE</span>'
    };
    return badges[urgency || 'future'] || badges['future'];
}

/**
 * Render the Top 10 Opportunities Matrix
 * Shows highest-value opportunities across all categories
 * Sorted by valueUSD in descending order
 * Includes proper accessibility attributes (ARIA roles and labels)
 */
function renderTopOpportunities() {
    if (!programsData || !programsData.programs) return;
    
    const allPrograms = [
        ...(programsData.programs.funding || []),
        ...(programsData.programs.lidar || []),
        ...(programsData.programs.spaceSystems || []),
        ...(programsData.programs.platform || [])
    ];
    
    // Remove duplicates by ID
    const uniquePrograms = Array.from(new Map(allPrograms.map(p => [p.id, p])).values());
    
    // Sort by value (descending) and urgency (urgent first)
    const sortedPrograms = uniquePrograms.sort((a, b) => {
        // Prioritize urgent items
        if (a.urgency === 'urgent' && b.urgency !== 'urgent') return -1;
        if (a.urgency !== 'urgent' && b.urgency === 'urgent') return 1;
        // Then sort by value
        return (b.valueUSD || 0) - (a.valueUSD || 0);
    });
    
    // Take top 10
    const top10 = sortedPrograms.slice(0, 10);
    
    const tbody = document.getElementById('top-opportunities-body');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    
    if (top10.length === 0) {
        // Colspan must match total number of columns in table header (10 columns)
        tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; padding: 2rem; color: var(--nuview-gray);">No opportunities available.</td></tr>';
        return;
    }
    
    top10.forEach((program, index) => {
        const row = document.createElement('tr');
        row.setAttribute('role', 'row');
        row.innerHTML = `
            <td class="matrix-rank" role="cell">${index + 1}</td>
            <td role="cell"><strong>${program.title || 'Untitled Program'}</strong></td>
            <td role="cell">
                ${program.agencyLink ? `
                <a href="${program.agencyLink}" target="_blank" rel="noopener noreferrer" 
                   style="color: var(--nuview-navy); text-decoration: underline;"
                   title="Visit ${program.agency || 'agency'} website">
                    ${program.agency || 'N/A'}
                </a>
                ` : program.agency || 'N/A'}
                <span class="matrix-source-badge" role="note" aria-label="Source type">${program.pillar || 'N/A'}</span>
            </td>
            <td role="cell">${program.category || 'N/A'}</td>
            <td class="matrix-value" role="cell">${formatCurrency(program.valueUSD || 0)}</td>
            <td role="cell">${program.deadline || 'TBD'} <small class="text-muted">(${program.daysUntil !== undefined ? program.daysUntil : 'N/A'} days)</small></td>
            <td role="cell">${getUrgencyBadge(program.urgency)}</td>
            <td role="cell" style="color: var(--nuview-red); font-weight: 600;">${program.nextAction || 'No action specified'}</td>
            <td class="matrix-link" role="cell">
                ${program.link && program.link !== '#' ? `
                <a href="${program.link}" target="_blank" rel="noopener noreferrer" 
                   class="matrix-link-btn" 
                   aria-label="View ${program.title || 'program'} opportunity"
                   tabindex="0">
                    View <i class="bi bi-box-arrow-up-right"></i>
                </a>
                ` : `
                <span class="matrix-link-btn" style="opacity: 0.5; cursor: not-allowed;" 
                      aria-label="Link not available"
                      tabindex="-1">
                    N/A
                </span>
                `}
            </td>
            <td class="matrix-link" role="cell">
                ${program.budgetSourceLink && program.budgetSourceLink !== '#' ? `
                <a href="${program.budgetSourceLink}" target="_blank" rel="noopener noreferrer" 
                   class="matrix-link-btn" 
                   aria-label="View budget source for ${program.title || 'program'}"
                   tabindex="0">
                    Budget <i class="bi bi-box-arrow-up-right"></i>
                </a>
                ` : `
                <span class="matrix-link-btn" style="opacity: 0.5; cursor: not-allowed;" 
                      aria-label="Budget source not available"
                      tabindex="-1">
                    N/A
                </span>
                `}
            </td>
        `;
        tbody.appendChild(row);
    });
}

// Render Priority Scoring Matrix
function renderPriorityMatrix() {
    if (!programsData || !programsData.programs) return;
    
    const allPrograms = [
        ...(programsData.programs.funding || []),
        ...(programsData.programs.lidar || []),
        ...(programsData.programs.spaceSystems || []),
        ...(programsData.programs.platform || [])
    ];
    
    // Remove duplicates by ID
    const uniquePrograms = Array.from(new Map(allPrograms.map(p => [p.id, p])).values());
    
    // Sort by priority score (descending)
    const sortedPrograms = uniquePrograms.sort((a, b) => {
        const scoreA = a.priorityScore || 0;
        const scoreB = b.priorityScore || 0;
        return scoreB - scoreA;
    });
    
    const tbody = document.getElementById('priority-matrix-body');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    
    if (sortedPrograms.length === 0) {
        tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; padding: 2rem; color: var(--nuview-gray);">No opportunities available.</td></tr>';
        return;
    }
    
    sortedPrograms.forEach((program, index) => {
        const row = document.createElement('tr');
        row.setAttribute('role', 'row');
        
        // Calculate score badge color based on score
        const score = program.priorityScore || 0;
        let scoreColor = 'var(--nuview-gray)'; // default gray
        if (score >= 70) scoreColor = 'var(--nuview-red)'; // high priority
        else if (score >= 50) scoreColor = '#ff9800'; // medium priority
        else if (score >= 30) scoreColor = '#2196F3'; // low priority
        
        row.innerHTML = `
            <td class="matrix-rank" role="cell">${index + 1}</td>
            <td role="cell"><strong>${program.title || 'Untitled Program'}</strong></td>
            <td role="cell">${program.agency || 'N/A'}</td>
            <td role="cell"><span class="matrix-source-badge">${program.pillar || 'N/A'}</span></td>
            <td role="cell">${program.category || 'N/A'}</td>
            <td class="matrix-value" role="cell">${formatCurrency(program.valueUSD || 0)}</td>
            <td role="cell">
                <span style="display: inline-block; background: ${scoreColor}; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-weight: bold; min-width: 45px; text-align: center;">
                    ${score}
                </span>
            </td>
            <td role="cell">${getUrgencyBadge(program.urgency)}</td>
            <td role="cell">${program.daysUntil !== undefined ? program.daysUntil : 'N/A'}</td>
            <td role="cell">${program.deadline || 'TBD'}</td>
        `;
        tbody.appendChild(row);
    });
}

// Create program card
function createProgramCard(program) {
    const card = document.createElement('div');
    card.className = 'program-card';
    card.setAttribute('data-searchable', `${program.title || ''} ${program.agency || ''} ${program.category || ''} ${program.nextAction || ''}`.toLowerCase());
    
    const title = program.title || 'Untitled Program';
    const agency = program.agency || 'N/A';
    const agencyLink = program.agencyLink || '#';
    const value = formatCurrency(program.valueUSD || 0);
    const deadline = program.deadline || 'TBD';
    const daysUntil = program.daysUntil !== undefined ? program.daysUntil : 'N/A';
    const urgency = program.urgency || 'future';
    const nextAction = program.nextAction || 'No action specified';
    const description = program.description || 'No description available';
    const link = program.link || '#';
    const budgetSourceLink = program.budgetSourceLink || '#';
    
    card.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
            <div>
                <h5 style="margin: 0; color: var(--nuview-navy);">${title}</h5>
                <p style="margin: 0.25rem 0; color: #666; font-size: 0.9rem;">${description}</p>
            </div>
            ${getUrgencyBadge(urgency)}
        </div>
        <div class="row" style="margin-top: 1rem; font-size: 0.9rem;">
            <div class="col-md-3">
                <strong>Agency:</strong> ${agencyLink !== '#' ? `<a href="${agencyLink}" target="_blank" style="color: var(--nuview-navy); text-decoration: underline;" title="Visit agency website">${agency}</a>` : agency}
            </div>
            <div class="col-md-3">
                <strong>Value:</strong> ${value}
            </div>
            <div class="col-md-3">
                <strong>Deadline:</strong> ${deadline} (${daysUntil} days)
            </div>
            <div class="col-md-3">
                <strong>Opp:</strong> <a href="${link}" target="_blank" style="color: var(--nuview-red); font-weight: 600;" title="View opportunity">View</a>
                ${budgetSourceLink !== '#' ? ` | <strong>Budget:</strong> <a href="${budgetSourceLink}" target="_blank" style="color: var(--nuview-red); font-weight: 600;" title="View budget source">Source</a>` : ''}
            </div>
        </div>
        <div style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid #eee;">
            <strong style="color: var(--nuview-red);">Next Action:</strong> ${nextAction}
        </div>
    `;
    
    return card;
}

// Render programs in a section
function renderPrograms(programs, containerId) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    container.innerHTML = '';
    
    if (!programs || programs.length === 0) {
        container.innerHTML = '<p style="color: #999;">No programs in this category.</p>';
        return;
    }
    
    programs.forEach(program => {
        container.appendChild(createProgramCard(program));
    });
}

// Update overview statistics
function updateOverview() {
    if (!programsData || !programsData.programs) return;
    
    const allPrograms = [
        ...(programsData.programs.funding || []),
        ...(programsData.programs.lidar || []),
        ...(programsData.programs.spaceSystems || []),
        ...(programsData.programs.platform || [])
    ];
    
    // Remove duplicates by ID
    const uniquePrograms = Array.from(new Map(allPrograms.map(p => [p.id, p])).values());
    
    const totalValue = uniquePrograms.reduce((sum, p) => sum + (p.valueUSD || 0), 0);
    const urgentCount = uniquePrograms.filter(p => p.urgency === 'urgent').length;
    
    document.getElementById('total-programs').textContent = uniquePrograms.length;
    document.getElementById('total-value').textContent = formatCurrency(totalValue);
    document.getElementById('urgent-programs').textContent = urgentCount;
    
    if (programsData.meta && programsData.meta.updated) {
        const date = new Date(programsData.meta.updated);
        document.getElementById('last-updated').textContent = date.toLocaleDateString();
    }
}

/**
 * Setup global search functionality
 * Searches across all program cards based on searchable text attributes
 * Shows/hides cards based on search match
 * Search is case-insensitive and matches partial strings
 */
function setupGlobalSearch() {
    const searchInput = document.getElementById('globalSearch');
    if (!searchInput) return;
    
    searchInput.addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase(); // FIXED: use e.target.value
        const allCards = document.querySelectorAll('.program-card');
        
        allCards.forEach(card => {
            const searchableText = card.getAttribute('data-searchable') || '';
            if (searchableText.includes(searchTerm)) {
                card.classList.remove('hidden');
            } else {
                card.classList.add('hidden');
            }
        });
    });
}

// Format deadline display
function formatDeadlineDisplay(deadline, daysUntil) {
    const deadlineStr = deadline || 'TBD';
    if (daysUntil !== undefined && daysUntil !== null) {
        return `${deadlineStr} (${daysUntil} days)`;
    }
    return deadlineStr;
}

// Constants for opportunity filtering
const URGENT_DAYS_THRESHOLD = 30;

// Render Launched Opportunities Box
function renderLaunchedOpps() {
    if (!programsData || !programsData.programs) return;
    
    const allPrograms = [
        ...(programsData.programs.funding || []),
        ...(programsData.programs.lidar || []),
        ...(programsData.programs.spaceSystems || []),
        ...(programsData.programs.platform || [])
    ];
    
    // Remove duplicates by ID
    const uniquePrograms = Array.from(new Map(allPrograms.map(p => [p.id, p])).values());
    
    // Filter for launched opportunities (those with daysUntil < 0 or status indicating launched)
    // For demo purposes, we'll show the most recent/urgent opportunities
    const launchedOpps = uniquePrograms
        .filter(p => p.urgency === 'urgent' || (p.daysUntil !== undefined && p.daysUntil !== null && p.daysUntil <= URGENT_DAYS_THRESHOLD))
        .sort((a, b) => {
            const aDays = a.daysUntil ?? 999;
            const bDays = b.daysUntil ?? 999;
            return aDays - bDays;
        })
        .slice(0, 5);
    
    const container = document.getElementById('launched-opps-container');
    if (!container) return;
    
    if (launchedOpps.length === 0) {
        container.innerHTML = '<div class="launched-opps-empty">No recent launches</div>';
        return;
    }
    
    container.innerHTML = '';
    launchedOpps.forEach(opp => {
        const item = document.createElement('div');
        item.className = 'launched-opp-item';
        item.innerHTML = `
            <h4>${opp.title || 'Untitled'}</h4>
            <p><strong>Agency:</strong> ${opp.agency || 'N/A'}</p>
            <p><strong>Value:</strong> <span class="launched-opp-value">${formatCurrency(opp.valueUSD || 0)}</span></p>
            <p><strong>Deadline:</strong> ${formatDeadlineDisplay(opp.deadline, opp.daysUntil)}</p>
            ${opp.link && opp.link !== '#' ? `
            <p><a href="${opp.link}" target="_blank" rel="noopener noreferrer" class="launched-opp-link">View Details ‚Üí</a></p>
            ` : ''}
        `;
        container.appendChild(item);
    });
}


// Load programs data
async function loadPrograms() {
    try {
        const response = await fetch('../data/processed/programs.json');
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        programsData = await response.json();
        
        // Render top 10 opportunities matrix
        renderTopOpportunities();
        
        // Render priority scoring matrix
        renderPriorityMatrix();
        
        // Render launched opportunities box
        renderLaunchedOpps();
        
        // Render all sections with robust handling for missing data
        renderPrograms(programsData.programs?.funding || [], 'funding-programs');
        renderPrograms(programsData.programs?.lidar || [], 'lidar-programs');
        renderPrograms(programsData.programs?.spaceSystems || [], 'space-systems-programs');
        renderPrograms(programsData.programs?.platform || [], 'platform-programs');
        
        // Update overview
        updateOverview();
        
        // Setup global search
        setupGlobalSearch();
        
        // Initialize Cytoscape network diagram
        const allOpps = [
            ...(programsData.programs?.funding || []),
            ...(programsData.programs?.lidar || []),
            ...(programsData.programs?.spaceSystems || []),
            ...(programsData.programs?.platform || [])
        ];
        initializeCytoscapeNetwork(allOpps);
        
    } catch (error) {
        console.error('Error loading programs data:', error);
        const containers = ['funding-programs', 'lidar-programs', 'space-systems-programs', 'platform-programs'];
        containers.forEach(id => {
            const container = document.getElementById(id);
            if (container) {
                container.innerHTML = '<p style="color: var(--nuview-red);">Error loading data. Please check the console for details.</p>';
            }
        });
    }
}

// Initialize Cytoscape network diagram
function initializeCytoscapeNetwork(opportunities) {
    if (typeof cytoscape === 'undefined') {
        console.warn('Cytoscape library not loaded');
        return;
    }
    
    const container = document.getElementById('cy');
    if (!container) return;
    
    // Prepare data for Cytoscape
    const elements = [];
    const agencies = new Set();
    const categories = new Set();
    
    // Add opportunities and collect unique agencies/categories
    opportunities.slice(0, 20).forEach((opp, idx) => { // Limit to 20 for clarity
        const oppId = `opp-${idx}`;
        const agencyId = `agency-${opp.agency.replace(/\s+/g, '-')}`;
        const categoryId = `cat-${opp.category}`;
        
        agencies.add(agencyId);
        categories.add(categoryId);
        
        // Add opportunity node
        elements.push({
            data: {
                id: oppId,
                label: opp.title.substring(0, 30) + '...',
                type: 'opportunity',
                value: opp.amountUSD,
                fullTitle: opp.title
            }
        });
        
        // Add edges
        elements.push({
            data: {
                source: agencyId,
                target: oppId
            }
        });
        
        elements.push({
            data: {
                source: oppId,
                target: categoryId
            }
        });
    });
    
    // Add agency nodes
    agencies.forEach(agencyId => {
        elements.push({
            data: {
                id: agencyId,
                label: agencyId.replace('agency-', '').replace(/-/g, ' '),
                type: 'agency'
            }
        });
    });
    
    // Add category nodes
    categories.forEach(categoryId => {
        elements.push({
            data: {
                id: categoryId,
                label: categoryId.replace('cat-', ''),
                type: 'category'
            }
        });
    });
    
    // Initialize Cytoscape
    const cy = cytoscape({
        container: container,
        elements: elements,
        style: [
            {
                selector: 'node',
                style: {
                    'label': 'data(label)',
                    'text-valign': 'center',
                    'text-halign': 'center',
                    'font-size': '10px',
                    'background-color': '#666',
                    'color': '#000',
                    'text-outline-color': '#fff',
                    'text-outline-width': 1
                }
            },
            {
                selector: 'node[type="agency"]',
                style: {
                    'background-color': '#E10600',
                    'width': 40,
                    'height': 40,
                    'font-size': '12px',
                    'font-weight': 'bold'
                }
            },
            {
                selector: 'node[type="category"]',
                style: {
                    'background-color': '#003366',
                    'width': 35,
                    'height': 35,
                    'font-size': '11px',
                    'font-weight': 'bold',
                    'color': '#fff'
                }
            },
            {
                selector: 'node[type="opportunity"]',
                style: {
                    'background-color': '#4CAF50',
                    'width': 'mapData(value, 0, 100000000, 20, 50)',
                    'height': 'mapData(value, 0, 100000000, 20, 50)'
                }
            },
            {
                selector: 'edge',
                style: {
                    'width': 2,
                    'line-color': '#ccc',
                    'target-arrow-color': '#ccc',
                    'target-arrow-shape': 'triangle',
                    'curve-style': 'bezier'
                }
            }
        ],
        layout: {
            name: 'cose',
            animate: true,
            animationDuration: 1000,
            nodeRepulsion: 8000,
            idealEdgeLength: 100,
            edgeElasticity: 100,
            nestingFactor: 1.2,
            gravity: 1,
            numIter: 1000,
            initialTemp: 200,
            coolingFactor: 0.95,
            minTemp: 1.0
        }
    });
    
    // Add interactive tooltips and click events
    cy.on('tap', 'node', function(evt) {
        const node = evt.target;
        const data = node.data();
        if (data.type === 'opportunity') {
            // Create a more detailed popup
            const details = `
Opportunity: ${data.fullTitle}
Value: $${(data.value || 0).toLocaleString()}
Type: ${data.type}

Click outside to close`;
            alert(details);
        } else if (data.type === 'agency') {
            alert(`Agency: ${data.label}\n\nRepresents opportunities from this agency.\nClick outside to close.`);
        } else if (data.type === 'category') {
            alert(`Category: ${data.label}\n\nRepresents opportunities in this category.\nClick outside to close.`);
        }
    });
    
    // Add hover effects
    cy.on('mouseover', 'node', function(evt) {
        const node = evt.target;
        node.style('border-width', '3px');
        node.style('border-color', '#E10600');
    });
    
    cy.on('mouseout', 'node', function(evt) {
        const node = evt.target;
        node.style('border-width', '0px');
    });
    
    // Enable zoom and pan
    cy.userZoomingEnabled(true);
    cy.userPanningEnabled(true);
    cy.boxSelectionEnabled(false);
    
    // Add zoom controls info
    console.log('Cytoscape controls: Mouse wheel to zoom, drag to pan, click nodes for details');
    
    console.log('Cytoscape network initialized with', elements.length, 'elements');
}

/**
 * ============================================
 * INITIALIZATION
 * ============================================
 */

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    loadPrograms();
    initializePipelineTooltips();
    
    // Initialize scoring details toggle
    const toggleBtn = document.getElementById('toggle-scoring-details');
    const scoringDetails = document.getElementById('scoring-details');
    
    if (toggleBtn && scoringDetails) {
        toggleBtn.addEventListener('click', function() {
            if (scoringDetails.style.display === 'none') {
                scoringDetails.style.display = 'block';
                toggleBtn.textContent = 'Hide Scoring Details';
            } else {
                scoringDetails.style.display = 'none';
                toggleBtn.textContent = 'Show Scoring Details';
            }
        });
    }
});

/**
 * Initialize pipeline stage tooltips
 * Displays detailed descriptions of each pipeline stage on hover
 * Tooltips include: Data Sources, Processing Engine, Scoring System, Priority Matrix
 * Positioned dynamically based on mouse position
 */
function initializePipelineTooltips() {
    // Tooltip positioning constants
    const TOOLTIP_HORIZONTAL_OFFSET = 140; // Half tooltip width for centering
    const TOOLTIP_VERTICAL_OFFSET = 15; // Gap between tooltip and element
    
    const tooltipData = {
        sources: {
            title: 'Data Sources',
            description: 'We aggregate opportunities from federal contract databases (SAM.gov), NASA ROSES, research grants, and industry reports. Automated scrapers collect data daily to ensure comprehensive coverage.'
        },
        engine: {
            title: 'Processing Engine',
            description: 'Our engine normalizes data from various formats, matches duplicate entries across sources, and enriches records with additional context. This ensures clean, consistent data for analysis.'
        },
        scoring: {
            title: 'Scoring System',
            description: 'Each opportunity receives scores for financial value, strategic alignment with NUVIEW capabilities, deadline urgency, and execution risk. These scores drive prioritization and action planning.'
        },
        matrix: {
            title: 'Priority Matrix',
            description: 'High-scoring opportunities are organized into the priority matrix, generating alerts for urgent actions, updating dashboards in real-time, and distributing reports to stakeholders.'
        }
    };
    
    // Create tooltip element
    const tooltip = document.createElement('div');
    tooltip.className = 'pipeline-tooltip';
    document.body.appendChild(tooltip);
    
    // Add event listeners to pipeline stages
    const stages = document.querySelectorAll('.pipeline-stage');
    stages.forEach(stage => {
        stage.addEventListener('mouseenter', function(e) {
            const stageType = this.getAttribute('data-stage');
            const data = tooltipData[stageType];
            
            if (data) {
                tooltip.innerHTML = `<strong style="color: var(--nuview-red);">${data.title}</strong><br><span style="color: #e9ecef;">${data.description}</span>`;
                tooltip.classList.add('show');
            }
        });
        
        stage.addEventListener('mousemove', function(e) {
            const rect = this.getBoundingClientRect();
            tooltip.style.left = (e.clientX - TOOLTIP_HORIZONTAL_OFFSET) + 'px';
            tooltip.style.top = (rect.top - tooltip.offsetHeight - TOOLTIP_VERTICAL_OFFSET + window.scrollY) + 'px';
        });
        
        stage.addEventListener('mouseleave', function() {
            tooltip.classList.remove('show');
        });
    });
}

// ========================================
// FLOATING ROCKET BUTTON & AUTHENTICATION
// ========================================

// Show rocket tooltip on hover
function initRocketButton() {
    const rocketBtn = document.getElementById('rocketBtn');
    const rocketTooltip = document.getElementById('rocketTooltip');
    const authModal = document.getElementById('authModal');
    
    if (!rocketBtn || !rocketTooltip || !authModal) return;
    
    // Tooltip show/hide
    rocketBtn.addEventListener('mouseenter', function() {
        rocketTooltip.classList.add('show');
    });
    
    rocketBtn.addEventListener('mouseleave', function() {
        rocketTooltip.classList.remove('show');
    });
    
    // Show modal on click
    rocketBtn.addEventListener('click', function() {
        rocketTooltip.classList.remove('show');
        authModal.classList.add('show');
        document.getElementById('authToken').focus();
    });
}

// Close modal
function closeAuthModal() {
    const authModal = document.getElementById('authModal');
    const authError = document.getElementById('authError');
    const authSuccess = document.getElementById('authSuccess');
    const authToken = document.getElementById('authToken');
    
    authModal.classList.remove('show');
    authError.classList.remove('show');
    authSuccess.classList.remove('show');
    authToken.value = '';
}

// Trigger scrape with authentication
async function triggerScrape() {
    const authToken = document.getElementById('authToken').value.trim();
    const authError = document.getElementById('authError');
    const authSuccess = document.getElementById('authSuccess');
    const triggerBtn = document.getElementById('triggerBtn');
    const instructionsDiv = document.getElementById('triggerInstructions');
    
    // Reset messages
    authError.classList.remove('show');
    authSuccess.classList.remove('show');
    
    // Validate input
    if (!authToken) {
        authError.textContent = '‚ö†Ô∏è Please enter your NUVIEW trigger code';
        authError.classList.add('show');
        return;
    }
    
    // Get repository info from current URL (works for any GitHub Pages site)
    const currentUrl = window.location.href;
    const repoMatch = currentUrl.match(/github\.io\/([^\/]+)/);
    const repoName = repoMatch ? repoMatch[1] : 'nuview-strategic-pipeline';
    
    // Show instructions
    instructionsDiv.classList.add('show');
    
    // Update the link dynamically
    const workflowLink = instructionsDiv.querySelector('a');
    if (workflowLink) {
        // Extract owner from meta tag or default to JacobThielNUVIEW
        const owner = 'JacobThielNUVIEW';
        workflowLink.href = `https://github.com/${owner}/${repoName}/actions/workflows/trigger-local-scrape.yml`;
    }
    
    authSuccess.innerHTML = `
        <strong>‚úÖ Code Verified!</strong><br>
        Follow these steps to trigger the scrape:
    `;
    authSuccess.classList.add('show');
    
    // Disable trigger button, show it's complete
    triggerBtn.disabled = true;
    triggerBtn.textContent = '‚úì Code Ready';
    
    // Animate rocket
    const rocketBtn = document.getElementById('rocketBtn');
    rocketBtn.classList.add('launching');
    setTimeout(() => {
        rocketBtn.classList.remove('launching');
    }, 1500);
}

// Handle Enter key in auth input
function handleAuthKeyPress(event) {
    if (event.key === 'Enter') {
        triggerScrape();
    }
}

// Close modal when clicking outside
window.addEventListener('click', function(event) {
    const authModal = document.getElementById('authModal');
    if (event.target === authModal) {
        closeAuthModal();
    }
});

// Auto-refresh functionality - refresh data every 5 minutes (300000 ms)
function startAutoRefresh() {
    console.log('Auto-refresh enabled: Data will refresh every 5 minutes');
    setInterval(function() {
        console.log('Auto-refreshing data...');
        loadPrograms();
    }, 300000); // 5 minutes = 300,000 milliseconds
}

// Initialize rocket button on page load
document.addEventListener('DOMContentLoaded', function() {
    loadPrograms();
    initializePipelineTooltips();
    initRocketButton();
    startAutoRefresh(); // Start auto-refresh on page load
});
</script>

<!-- Floating Rocket Button -->
<button id="rocketBtn" class="floating-rocket-btn" aria-label="Trigger data update" title="Trigger Data Update">
    üöÄ
</button>

<!-- Rocket Tooltip -->
<div id="rocketTooltip" class="rocket-tooltip">
    üöÄ Trigger Data Update
</div>

<!-- Authentication Modal -->
<div id="authModal" class="auth-modal" role="dialog" aria-labelledby="authModalTitle" aria-modal="true">
    <div class="auth-modal-content">
        <div class="auth-modal-header">
            <div class="rocket-icon">üöÄ</div>
            <h2 id="authModalTitle">Trigger Local Scrape</h2>
        </div>
        
        <div class="auth-modal-body">
            <p>Enter your NUVIEW trigger code to trigger a data update on your local machine.</p>
            
            <div id="authError" class="auth-error"></div>
            <div id="authSuccess" class="auth-success"></div>
            
            <div class="auth-input-group">
                <label for="authToken">
                    <i class="bi bi-shield-lock"></i> Trigger Code
                </label>
                <input 
                    type="password" 
                    id="authToken" 
                    placeholder="Enter your NUVIEW trigger code..."
                    onkeypress="handleAuthKeyPress(event)"
                    autocomplete="off"
                >
            </div>
            
            <div id="triggerInstructions" class="trigger-instructions">
                <h4>üöÄ How to Trigger the Scrape:</h4>
                <ol>
                    <li>
                        <strong>Go to GitHub Actions:</strong><br>
                        <a href="https://github.com/JacobThielNUVIEW/nuview-strategic-pipeline/actions/workflows/trigger-local-scrape.yml" target="_blank">
                            Click here to open the workflow
                        </a>
                    </li>
                    <li>
                        <strong>Click "Run workflow" button</strong> (top right)
                    </li>
                    <li>
                        <strong>Enter your code</strong> in the "Trigger code" field
                    </li>
                    <li>
                        <strong>Click "Run workflow"</strong> to start
                    </li>
                    <li>
                        Your local machine will automatically detect the trigger and run the scrape!
                    </li>
                </ol>
            </div>
        </div>
        
        <div class="auth-modal-footer">
            <button class="auth-btn auth-btn-secondary" onclick="closeAuthModal()">
                Cancel
            </button>
            <button id="triggerBtn" class="auth-btn auth-btn-primary" onclick="triggerScrape()">
                üöÄ Launch Scrape
            </button>
        </div>
    </div>
</div>

</body>
</html>
